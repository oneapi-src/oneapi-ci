# SPDX-FileCopyrightText: 2022 Intel Corporation
#
# SPDX-License-Identifier: MIT

environment:
  global:
    WINDOWS_BASEKIT_URL: https://registrationcenter-download.intel.com/akdlm//IRC_NAS/c997c613-a165-48a0-aeb7-9932899c0cf1/w_BaseKit_p_2024.0.0.49557_offline.exe
    WINDOWS_HPCKIT_URL: https://registrationcenter-download.intel.com/akdlm//IRC_NAS/23d88996-7eeb-414b-9da5-e33c5c285c6a/w_HPCKit_p_2024.0.0.49577_offline.exe
    LINUX_BASEKIT_URL: https://registrationcenter-download.intel.com/akdlm//IRC_NAS/785409ee-4825-44b6-af24-ea8b5df4866b/l_BaseKit_p_2024.0.0.49556_offline.sh
    LINUX_HPCKIT_URL: https://registrationcenter-download.intel.com/akdlm//IRC_NAS/c5cee152-b1b7-40b2-ac59-861c48f47b6c/l_HPCKit_p_2024.0.0.49582_offline.sh
    MACOS_HPCKIT_URL: https://registrationcenter-download.intel.com/akdlm/IRC_NAS/edb4dc2f-266f-47f2-8d56-21bc7764e119/m_HPCKit_p_2023.2.0.49443_offline.dmg
    WINDOWS_CPP_COMPONENTS: intel.oneapi.win.cpp-compiler
    WINDOWS_FORTRAN_COMPONENTS: intel.oneapi.win.ifort-compiler
    WINDOWS_DPCPP_COMPONENTS: intel.oneapi.win.dpcpp-compiler
    LINUX_CPP_COMPONENTS: intel-oneapi-compiler-dpcpp-cpp-and-cpp-classic
    LINUX_FORTRAN_COMPONENTS: intel-oneapi-compiler-fortran
    LINUX_DPCPP_COMPONENTS: intel-oneapi-compiler-dpcpp-cpp
    LINUX_CPP_COMPONENTS_WEB: intel.oneapi.lin.dpcpp-cpp-compiler-pro
    LINUX_FORTRAN_COMPONENTS_WEB: intel.oneapi.lin.ifort-compiler
    LINUX_DPCPP_COMPONENTS_WEB: intel.oneapi.lin.dpcpp-cpp-compiler
    MACOS_CPP_COMPONENTS: intel.oneapi.mac.cpp-compiler
    MACOS_FORTRAN_COMPONENTS: intel.oneapi.mac.ifort-compiler
    SAMPLES_TAG: 2024.0.0
    VS_VER: vs2019

  matrix:
    - job_name: build_windows_cpp
      appveyor_build_worker_image: Visual Studio 2019

    - job_name: build_windows_fortran
      appveyor_build_worker_image: Visual Studio 2019

    - job_name: build_windows_dpcpp
      appveyor_build_worker_image: Visual Studio 2019

    - job_name: build_linux_cpp
      appveyor_build_worker_image: ubuntu2004

    - job_name: build_linux_fortran
      appveyor_build_worker_image: ubuntu2004

    - job_name: build_linux_dpcpp
      appveyor_build_worker_image: ubuntu2004

    - job_name: build_linux_apt_cpp
      appveyor_build_worker_image: ubuntu2004

    - job_name: build_linux_apt_fortran
      appveyor_build_worker_image: ubuntu2004

    - job_name: build_linux_apt_dpcpp
      appveyor_build_worker_image: ubuntu2004

    - job_name: build_mac_cpp
      appveyor_build_worker_image: macos

    - job_name: build_mac_fortran
      appveyor_build_worker_image: macos

for:
  -
    matrix:
      only:
        - job_name: build_windows_cpp
    install:
      cmd: scripts/install_windows.bat %WINDOWS_HPCKIT_URL% %WINDOWS_CPP_COMPONENTS%
    build_script:
      cmd: scripts/build_windows.bat c++ %VS_VER% %SAMPLES_TAG%

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          extract.log
          bootstrapper*
          installer*
  -
    matrix:
      only:
        - job_name: build_windows_fortran
    install:
      cmd: scripts/install_windows.bat %WINDOWS_HPCKIT_URL% %WINDOWS_FORTRAN_COMPONENTS%
    build_script:
      cmd: scripts/build_windows.bat fortran %VS_VER% %SAMPLES_TAG%

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          extract.log
          bootstrapper*
          installer*
  -
    matrix:
      only:
        - job_name: build_windows_dpcpp
    install:
      cmd: scripts/install_windows.bat %WINDOWS_BASEKIT_URL% %WINDOWS_DPCPP_COMPONENTS%
    build_script:
      cmd: scripts/build_windows.bat dpc++ %VS_VER% %SAMPLES_TAG%

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          extract.log
          bootstrapper*
          installer*
  -
    matrix:
      only:
        - job_name: build_linux_cpp
    install:
      sh: |
        scripts/install_linux.sh $LINUX_HPCKIT_URL $LINUX_CPP_COMPONENTS_WEB
    build_script:
      sh: scripts/build_linux.sh c++ $SAMPLES_TAG

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          extract.log
          bootstrapper*
          installer*

  -
    matrix:
      only:
        - job_name: build_linux_fortran
    install:
      sh: |
        scripts/install_linux.sh $LINUX_HPCKIT_URL $LINUX_FORTRAN_COMPONENTS_WEB
    build_script:
      sh: scripts/build_linux.sh fortran $SAMPLES_TAG

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          extract.log
          bootstrapper*
          installer*

  -
    matrix:
      only:
        - job_name: build_linux_dpcpp
    install:
      sh: |
        scripts/install_linux.sh $LINUX_BASEKIT_URL $LINUX_DPCPP_COMPONENTS_WEB
    build_script:
      sh: scripts/build_linux.sh dpc++ $SAMPLES_TAG

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          extract.log
          bootstrapper*
          installer*

  -
    matrix:
      only:
        - job_name: build_linux_apt_cpp
    install:
      sh: |
        scripts/setup_apt_repo_linux.sh
        scripts/install_linux_apt.sh $LINUX_CPP_COMPONENTS
    build_script:
      sh: scripts/build_linux.sh c++ $SAMPLES_TAG
  -
    matrix:
      only:
        - job_name: build_linux_apt_fortran
    install:
      sh: |
        scripts/setup_apt_repo_linux.sh
        scripts/install_linux_apt.sh $LINUX_FORTRAN_COMPONENTS
    build_script:
      sh: scripts/build_linux.sh fortran $SAMPLES_TAG
  -
    matrix:
      only:
        - job_name: build_linux_apt_dpcpp
    install:
      sh: |
        scripts/setup_apt_repo_linux.sh
        scripts/install_linux_apt.sh $LINUX_DPCPP_COMPONENTS
    build_script:
      sh: scripts/build_linux.sh dpc++ $SAMPLES_TAG

  -
    matrix:
      only:
        - job_name: build_mac_cpp
    install:
      sh: scripts/install_macos.sh $MACOS_HPCKIT_URL $MACOS_CPP_COMPONENTS
    build_script:
      sh: scripts/build_macos.sh c++ $SAMPLES_TAG

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          bootstrapper*
          installer*
  -
    matrix:
      only:
        - job_name: build_mac_fortran
    install:
      sh: scripts/install_macos.sh $MACOS_HPCKIT_URL $MACOS_FORTRAN_COMPONENTS
    build_script:
      sh: scripts/build_macos.sh fortran $SAMPLES_TAG

    # Delete the following if you don't want to save install logs
    artifacts:
      - name: InstallLogs
        path: |
          bootstrapper*
          installer*
